
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{20180116\_example\_analyses\_release}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{Extract low-pass LFPs}\label{extract-low-pass-lfps}

Extract low-pass LFPs from selected trials.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{c+c1}{\PYZsh{} notebook configuration and Python 2/3 compatibility imports}
         \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
         \PY{o}{\PYZpc{}}\PY{k}{load\PYZus{}ext} autoreload
         \PY{o}{\PYZpc{}}\PY{k}{autoreload} 2
         \PY{k+kn}{from} \PY{n+nn}{\PYZus{}\PYZus{}future\PYZus{}\PYZus{}} \PY{k+kn}{import} \PY{n}{absolute\PYZus{}import}
         \PY{k+kn}{from} \PY{n+nn}{\PYZus{}\PYZus{}future\PYZus{}\PYZus{}} \PY{k+kn}{import} \PY{n}{with\PYZus{}statement}
         \PY{k+kn}{from} \PY{n+nn}{\PYZus{}\PYZus{}future\PYZus{}\PYZus{}} \PY{k+kn}{import} \PY{n}{division}
         \PY{k+kn}{from} \PY{n+nn}{\PYZus{}\PYZus{}future\PYZus{}\PYZus{}} \PY{k+kn}{import} \PY{n}{nested\PYZus{}scopes}
         \PY{k+kn}{from} \PY{n+nn}{\PYZus{}\PYZus{}future\PYZus{}\PYZus{}} \PY{k+kn}{import} \PY{n}{generators}
         \PY{k+kn}{from} \PY{n+nn}{\PYZus{}\PYZus{}future\PYZus{}\PYZus{}} \PY{k+kn}{import} \PY{n}{unicode\PYZus{}literals}
         \PY{k+kn}{from} \PY{n+nn}{\PYZus{}\PYZus{}future\PYZus{}\PYZus{}} \PY{k+kn}{import} \PY{n}{print\PYZus{}function}
         
         \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ready}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
The autoreload extension is already loaded. To reload it, use:
  \%reload\_ext autoreload
Ready

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{c+c1}{\PYZsh{} A partial copy of m. rule\PYZsq{}s neurotools package is bundled with this example}
         \PY{c+c1}{\PYZsh{} The full package is on github, but is unstable \PYZdq{}research\PYZdq{} quality code. }
         \PY{k+kn}{import} \PY{n+nn}{neurotools\PYZus{}partial}
         \PY{k+kn}{from} \PY{n+nn}{neurotools\PYZus{}partial.spatial.dct} \PY{k+kn}{import} \PY{o}{*}
         \PY{k+kn}{from} \PY{n+nn}{neurotools\PYZus{}partial.spatial.array} \PY{k+kn}{import} \PY{o}{*}
         \PY{k+kn}{from} \PY{n+nn}{neurotools\PYZus{}partial.spatial.phase} \PY{k+kn}{import} \PY{o}{*}
         \PY{k+kn}{from} \PY{n+nn}{neurotools\PYZus{}partial.spatial.fftzeros} \PY{k+kn}{import} \PY{o}{*}
         \PY{k+kn}{from} \PY{n+nn}{neurotools\PYZus{}partial.jobs.parallel} \PY{k+kn}{import} \PY{o}{*}
         \PY{k+kn}{from} \PY{n+nn}{neurotools\PYZus{}partial.signal.signal} \PY{k+kn}{import} \PY{n}{remove\PYZus{}short}
         
         \PY{k+kn}{from} \PY{n+nn}{scipy.io} \PY{k+kn}{import} \PY{n}{loadmat}
         \PY{k+kn}{from} \PY{n+nn}{pylab} \PY{k+kn}{import} \PY{o}{*}
\end{Verbatim}


    \subsection{Constants}\label{constants}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n}{Fs}       \PY{o}{=} \PY{l+m+mi}{1000} \PY{c+c1}{\PYZsh{} Samples per second}
         \PY{n}{Espacing} \PY{o}{=} \PY{l+m+mf}{0.4}  \PY{c+c1}{\PYZsh{} Inter\PYZhy{}electrode spacing in mm}
\end{Verbatim}


    \section{PMv wave diversity example}\label{pmv-wave-diversity-example}

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Load data
\item
  Plot data
\item
  Critical points
\item
  Wave classification
\end{enumerate}

    \subsection{Load data}\label{load-data}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{session} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SPK120918}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{area}    \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PMv}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{name}    \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{\PYZus{}analytic\PYZus{}beta\PYZus{}LFP\PYZus{}select\PYZus{}trials}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{session}\PY{p}{,}\PY{n}{area}\PY{p}{)}
         \PY{n}{data}    \PY{o}{=} \PY{n}{loadmat}\PY{p}{(}\PY{n}{name}\PY{p}{,}\PY{n}{squeeze\PYZus{}me}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n}{x}       \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{betaAnalyticLFP1kHz}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{fa}      \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{fb}      \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{fmid}    \PY{o}{=} \PY{n}{sqrt}\PY{p}{(}\PY{n}{fa}\PY{o}{*}\PY{n}{fb}\PY{p}{)}
         \PY{n}{Ntrials}\PY{p}{,} \PY{n}{Nrows}\PY{p}{,} \PY{n}{Ncols}\PY{p}{,} \PY{n}{Nms} \PY{o}{=} \PY{n}{x}\PY{o}{.}\PY{n}{shape}
         
         \PY{k}{print}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{README}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{====Summary of }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{====}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{name})
         \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Beta range }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{ \PYZhy{} }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{ Hz}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{fa}\PY{p}{,}\PY{n}{fb}\PY{p}{)}\PY{p}{)}
         \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{ trials}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{Ntrials})
         \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{ ms per trial}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{Nms})
         \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{ x }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{ spatial grid}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{Nrows}\PY{p}{,} \PY{n}{Ncols}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

This archive contains selected spatiotemporal beta-LFP from the Cued Grasp 
with Instructed Delay (CGID) task for session SPK120918 area PMv. These data are
provided for illustration purposes only, to demonstrate routines for 
calculating spatiotemporal phase statistics on multi-electrode arrays.
This archive includes data only from the one-second period before the 
object illumination in the CGID task.

The variables are as follows:

README:
    This message

betaAnalyticLFP1kHz:
    Ntrials x 10 x 10 x Ntimes complex-valued array of beta-LFP analytic signals
    For each trial, there is a 10 x 10 grid of beta-LFP analytic signals, 
    sampled at 1 kHz. LFP have been extracted using 4th order Butterworth 
    filtering applied forwards and backwards, with a low-frequency cutoff of 
    18.6 Hz and a high-frequency cutoff of 23.6 Hz. Analytic signals are 
    constructed using the Hilbert transform.

Ntrials : int
    Number of select trials provided for example

fa : float
    Beta-LFP band low-frequency cutoff

fb : float
    Beta-LFP band high-frequency cutoff


====Summary of SPK120918\_PMv\_analytic\_beta\_LFP\_select\_trials====
Beta range 18 - 23 Hz
60 trials
1000 ms per trial
10 x 10 spatial grid

    \end{Verbatim}

    \subsection{Preview data}\label{preview-data}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{} Plotting configuration}
         \PY{n}{tidx}     \PY{o}{=} \PY{l+m+mi}{7}   \PY{c+c1}{\PYZsh{} which trial to preview}
         \PY{n}{smooth}   \PY{o}{=} \PY{l+m+mf}{2.0} \PY{c+c1}{\PYZsh{} mm: smoothing radius for denoising}
         \PY{n}{upsample} \PY{o}{=} \PY{l+m+mi}{16}  \PY{c+c1}{\PYZsh{} Upsampling factor for plotting}
         \PY{n}{skip}     \PY{o}{=} \PY{l+m+mi}{5}   \PY{c+c1}{\PYZsh{} show every `skip` samples}
         \PY{n}{vrange}   \PY{o}{=} \PY{l+m+mi}{20}  \PY{c+c1}{\PYZsh{} millivolts; signal range}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{} Plot raw data}
         \PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
             \PY{n}{time} \PY{o}{=} \PY{n}{i}\PY{o}{*}\PY{n}{skip}
             \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{imshow}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{n}{tidx}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{time}\PY{p}{]}\PY{o}{.}\PY{n}{real}\PY{p}{,}\PY{n}{vmin}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{n}{vrange}\PY{p}{,}\PY{n}{vmax}\PY{o}{=}\PY{n}{vrange}\PY{p}{)}
             \PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{T=}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{time})
             \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}\PY{p}{;} \PY{n}{yticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
             \PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}0.1f}\PY{l+s+s1}{ mm}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{Ncols}\PY{o}{*}\PY{n}{Espacing}\PY{p}{)}\PY{p}{)}
         \PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Example trial }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{, wave preview — raw data}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{tidx}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{} Plot denoised example}
         \PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
             \PY{n}{time} \PY{o}{=} \PY{n}{i}\PY{o}{*}\PY{n}{skip}
             \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{w} \PY{o}{=} \PY{n}{dct\PYZus{}upsample}\PY{p}{(}\PY{n}{dct\PYZus{}cut\PYZus{}antialias}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{n}{tidx}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{time}\PY{p}{]}\PY{p}{,}\PY{n}{smooth}\PY{p}{)}\PY{p}{,}\PY{n}{upsample}\PY{p}{)}
             \PY{n}{imshow}\PY{p}{(}\PY{n}{w}\PY{o}{.}\PY{n}{real}\PY{p}{,}\PY{n}{vmin}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{n}{vrange}\PY{p}{,}\PY{n}{vmax}\PY{o}{=}\PY{n}{vrange}\PY{p}{)}
             \PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{T=}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{time})
             \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}\PY{p}{;} \PY{n}{yticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
             \PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}0.1f}\PY{l+s+s1}{ mm}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{Espacing}\PY{o}{*}\PY{p}{(}\PY{n}{Ncols}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Example trial }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{, denoised}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{tidx}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{;}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{} Plot phase maps}
         \PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
             \PY{n}{time} \PY{o}{=} \PY{n}{i}\PY{o}{*}\PY{n}{skip}
             \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{w} \PY{o}{=} \PY{n}{dct\PYZus{}upsample}\PY{p}{(}\PY{n}{dct\PYZus{}cut\PYZus{}antialias}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{n}{tidx}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{time}\PY{p}{]}\PY{p}{,}\PY{n}{smooth}\PY{p}{)}\PY{p}{,}\PY{n}{upsample}\PY{p}{)}
             \PY{n}{imshow}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{angle}\PY{p}{(}\PY{n}{w}\PY{p}{)}\PY{p}{,}\PY{n}{cmap} \PY{o}{=} \PY{n}{isolum}\PY{p}{,} \PY{n}{vmin}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{n}{pi}\PY{p}{,} \PY{n}{vmax}\PY{o}{=}\PY{n}{pi}\PY{p}{)}
             \PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{T=}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{time})
             \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}\PY{p}{;} \PY{n}{yticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
             \PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}0.1f}\PY{l+s+s1}{ mm}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{Espacing}\PY{o}{*}\PY{p}{(}\PY{n}{Ncols}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Example trial }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{, phase map}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{tidx}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_9_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_9_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_9_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{Parallelize critical-point detection over
frames}\label{parallelize-critical-point-detection-over-frames}

Critical point detection is computationally intensive. Analytic signals
are upsampled and smoothed, denoising the data and focusing on the
mesoscopic spatial scale. Radiating and saddle critical points are
estimated by looking for critical points in the discrete derivative.
Rotating centers are detected by a contour integral around each point,
computed as a convolution

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{c+c1}{\PYZsh{} Define critical\PYZhy{}point parallization helper routine}
         \PY{k}{def} \PY{n+nf}{critical\PYZus{}helper}\PY{p}{(}\PY{n}{params}\PY{p}{)}\PY{p}{:}
             \PY{p}{(}\PY{n}{i}\PY{p}{,}\PY{n}{x}\PY{p}{)} \PY{o}{=} \PY{n}{params}
             \PY{n}{x} \PY{o}{=} \PY{n}{dct\PYZus{}upsample}\PY{p}{(}\PY{n}{dct\PYZus{}cut\PYZus{}antialias}\PY{p}{(}\PY{n}{x}\PY{p}{,}\PY{n}{smooth}\PY{p}{)}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}
             \PY{n}{clockwise}\PY{p}{,} \PY{n}{anticlockwise}\PY{p}{,} \PY{n}{saddles}\PY{p}{,} \PY{n}{peaks}\PY{p}{,} \PY{n}{maxima}\PY{p}{,} \PY{n}{minima} \PY{o}{=} \PY{n}{find\PYZus{}critical\PYZus{}points}\PY{p}{(}\PY{n}{x}\PY{p}{,}\PY{n}{edgeavoid}\PY{o}{=}\PY{l+m+mi}{6}\PY{p}{)}
             \PY{k}{return} \PY{n}{i}\PY{p}{,}\PY{n+nb}{tuple}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{n+nb}{len}\PY{p}{,}\PY{p}{(}\PY{n}{clockwise}\PY{p}{,} \PY{n}{anticlockwise}\PY{p}{,} \PY{n}{maxima}\PY{p}{,} \PY{n}{minima}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{reset\PYZus{}pool}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Set up the parallel problem and compute in parallel}
         \PY{n}{problems} \PY{o}{=} \PY{p}{[}\PY{n}{frame} \PY{k}{for} \PY{n}{tidx} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{n}{Ntrials}\PY{p}{)} \PY{k}{for} \PY{n}{frame} \PY{o+ow}{in} \PY{n}{x}\PY{p}{[}\PY{n}{tidx}\PY{p}{]}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{]}
         
         \PY{c+c1}{\PYZsh{} If something goes on, try again with debug=True,}
         \PY{c+c1}{\PYZsh{} this will run all jobs from the main process, making it}
         \PY{c+c1}{\PYZsh{} easier to trace errors.}
         \PY{n}{cps}      \PY{o}{=} \PY{n}{parmap}\PY{p}{(}\PY{n}{critical\PYZus{}helper}\PY{p}{,}\PY{n+nb}{enumerate}\PY{p}{(}\PY{n}{problems}\PY{p}{)}\PY{p}{,}\PY{n}{debug}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{} Repack results into Ntrials x 4 x Nms}
         \PY{n}{critical} \PY{o}{=} \PY{n}{array}\PY{p}{(}\PY{n}{cps}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{n}{Ntrials}\PY{p}{,}\PY{n}{Nms}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Done}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

Done        

    \end{Verbatim}

    \subsection{Compute spatiotemporal summary
statistics}\label{compute-spatiotemporal-summary-statistics}

These include the spatially-averaged β-LFP amplitude envelope, an
amplitude-weighted synchrony statistic similar to the Kuramoto order
parameter, and a phase-gradient directionality measure.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n}{amplitudes} \PY{o}{=} \PY{n}{array}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{n}{array\PYZus{}average\PYZus{}amplitude}\PY{p}{,}\PY{n}{x}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{pgd}        \PY{o}{=} \PY{n}{array}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{map}\PY{p}{(}\PY{n}{array\PYZus{}synchrony\PYZus{}pgd}\PY{p}{,}\PY{n}{x}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{pgdstd}     \PY{o}{=} \PY{n}{sqrt}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{log}\PY{p}{(}\PY{n}{pgd}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{} Convert to units of radians}
         \PY{n}{syn}        \PY{o}{=} \PY{n}{population\PYZus{}synchrony}\PY{p}{(}\PY{n}{x}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         \PY{n}{std}        \PY{o}{=} \PY{n}{sqrt}\PY{p}{(}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{log}\PY{p}{(}\PY{n}{syn}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{} Convert to units of radians}
\end{Verbatim}


    \subsection{Define threshold for wave
categorization}\label{define-threshold-for-wave-categorization}

Thresholds here differ from the ones used in the paper, which were
computed based on statistics across all three areas. Wave transitions
are often continuous an no clear clusters emerge, but subjective
thresholds can be set to qualitatively, approximately, summarize the
diversity and variability.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{c+c1}{\PYZsh{} These thresholds are for illustration purposes only}
         \PY{n}{high\PYZus{}beta}             \PY{o}{=} \PY{l+m+mi}{15}      \PY{c+c1}{\PYZsh{} mV}
         \PY{n}{phase\PYZus{}gradient\PYZus{}sigma}  \PY{o}{=} \PY{n}{pi}\PY{o}{*}\PY{l+m+mf}{0.25} \PY{c+c1}{\PYZsh{} radians}
         \PY{n}{phase\PYZus{}synchrony\PYZus{}sigma} \PY{o}{=} \PY{n}{pi}\PY{o}{*}\PY{l+m+mf}{0.25} \PY{c+c1}{\PYZsh{} radians}
\end{Verbatim}


    \subsection{Plot example wave events}\label{plot-example-wave-events}

These are heuristic qualitative categories. Wave patterns transition
continuously between different states, and many edge-cases exist where
waves belong to more than one category. For example, highly synchronous
states can also exhibit spatial structure, such as planar or rotating
waves. For this reason (along with other evidence presented in the
paper), we argue that waves exist on a continuum between disorganized,
complex spatial structure, to spatially synchronized structure at higher
β-LFP amplitudes. Synchrony emerges as the limiting case of
long-wavelength planar, rotating, or complex waves.

(examples are selected randomly; re-run the code-block below to observe
different examples for rotating, radiating)

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{k+kn}{import} \PY{n+nn}{random}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{} Compute heuristic, qualitative wave categorization}
         \PY{c+c1}{\PYZsh{} (this is inexact, mainly used to summarize qualitative}
         \PY{c+c1}{\PYZsh{}  diversity; variability is continuous and ambiguous}
         \PY{c+c1}{\PYZsh{}  edge\PYZhy{}cases exist)}
         \PY{c+c1}{\PYZsh{} Get critical point counts}
         \PY{n}{Ndata} \PY{o}{=} \PY{n}{Ntrials}\PY{o}{*}\PY{n}{Nms}
         \PY{n}{cps}   \PY{o}{=} \PY{n}{array}\PY{p}{(}\PY{n}{critical}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{Ndata}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{}critical[tidx]}
         \PY{n}{clockwise}\PY{p}{,} \PY{n}{anticlockwise}\PY{p}{,} \PY{n}{maxima}\PY{p}{,} \PY{n}{minima} \PY{o}{=} \PY{n}{cps}
         \PY{n}{rotating} \PY{o}{=} \PY{n}{clockwise}\PY{o}{+}\PY{n}{anticlockwise}
         \PY{n}{peaks}    \PY{o}{=} \PY{n}{maxima}\PY{o}{+}\PY{n}{minima}
         \PY{c+c1}{\PYZsh{} Identify periods of radiating / rotating}
         \PY{n}{rotating}  \PY{o}{=} \PY{p}{(}\PY{n}{rotating}\PY{o}{==}\PY{l+m+mi}{1}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{peaks}   \PY{o}{==}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{radiating} \PY{o}{=} \PY{p}{(}\PY{n}{peaks}   \PY{o}{==}\PY{l+m+mi}{1}\PY{p}{)} \PY{o}{\PYZam{}} \PY{p}{(}\PY{n}{rotating}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{ncrit}     \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{cps}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
         \PY{n}{complexs}  \PY{o}{=} \PY{n}{ncrit}\PY{o}{\PYZgt{}}\PY{l+m+mi}{1}
         \PY{c+c1}{\PYZsh{} Detect plane wave, high\PYZhy{}beta, and synchrony events}
         \PY{n}{high}  \PY{o}{=} \PY{n}{amplitudes}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{n}{Ndata}\PY{p}{,}\PY{p}{)}\PY{p}{)} \PY{o}{\PYZgt{}} \PY{n}{high\PYZus{}beta}
         \PY{n}{plane} \PY{o}{=} \PY{n}{pgdstd}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{n}{Ndata}\PY{p}{,}\PY{p}{)}\PY{p}{)}     \PY{o}{\PYZlt{}} \PY{n}{phase\PYZus{}gradient\PYZus{}sigma}
         \PY{n}{synch} \PY{o}{=} \PY{n}{std}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{n}{Ndata}\PY{p}{,}\PY{p}{)}\PY{p}{)}        \PY{o}{\PYZlt{}} \PY{n}{phase\PYZus{}synchrony\PYZus{}sigma}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{} Categories are subjective and overlap; }
         \PY{c+c1}{\PYZsh{} Make categories mutually exclusive }
         \PY{c+c1}{\PYZsh{} (heuristic) for qualitative summary. }
         \PY{n}{exclude}    \PY{o}{=} \PY{n}{plane}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
         \PY{n}{radiating} \PY{o}{\PYZam{}}\PY{o}{=}\PY{o}{\PYZti{}}\PY{n}{exclude}
         \PY{n}{exclude}   \PY{o}{|}\PY{o}{=} \PY{n}{radiating}
         \PY{n}{rotating}  \PY{o}{\PYZam{}}\PY{o}{=}\PY{o}{\PYZti{}}\PY{n}{exclude}
         \PY{n}{exclude}   \PY{o}{|}\PY{o}{=} \PY{n}{rotating}
         \PY{n}{synch}     \PY{o}{\PYZam{}}\PY{o}{=}\PY{o}{\PYZti{}}\PY{n}{exclude} 
         \PY{n}{complexs}  \PY{o}{\PYZam{}}\PY{o}{=}\PY{o}{\PYZti{}}\PY{n}{exclude}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{} For illustration, truncate at the period of a beta oscillation}
         \PY{c+c1}{\PYZsh{} Averages in the paper were computed without truncating, in order }
         \PY{c+c1}{\PYZsh{} to faithfully summarize the overall distribution.}
         \PY{n}{tooshort}  \PY{o}{=} \PY{n+nb}{round}\PY{p}{(}\PY{n}{Fs}\PY{o}{/}\PY{n}{fmid}\PY{p}{)}
         \PY{n}{high}      \PY{o}{=} \PY{n}{remove\PYZus{}short}\PY{p}{(}\PY{n}{high} \PY{p}{,}\PY{n}{tooshort}\PY{p}{)}
         \PY{n}{plane}     \PY{o}{=} \PY{n}{remove\PYZus{}short}\PY{p}{(}\PY{n}{plane}\PY{p}{,}\PY{n}{tooshort}\PY{p}{)}
         \PY{n}{synch}     \PY{o}{=} \PY{n}{remove\PYZus{}short}\PY{p}{(}\PY{n}{synch}\PY{p}{,}\PY{n}{tooshort}\PY{p}{)}
         \PY{n}{rotating}  \PY{o}{=} \PY{n}{remove\PYZus{}short}\PY{p}{(}\PY{n}{rotating} \PY{p}{,}\PY{n}{tooshort}\PY{p}{)}
         \PY{n}{radiating} \PY{o}{=} \PY{n}{remove\PYZus{}short}\PY{p}{(}\PY{n}{radiating}\PY{p}{,}\PY{n}{tooshort}\PY{p}{)}
         \PY{n}{complexs}  \PY{o}{=} \PY{n}{remove\PYZus{}short}\PY{p}{(}\PY{n}{complexs} \PY{p}{,}\PY{n}{tooshort}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{} Locate an illustrative trile with wave diversity}
         \PY{n}{diverse} \PY{o}{=} \PYZbs{}
             \PY{p}{(}\PY{n+nb}{sum}\PY{p}{(}\PY{n}{complexs} \PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{n}{Ntrials}\PY{p}{,}\PY{n}{Nms}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{\PYZgt{}}\PY{l+m+mi}{40}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
             \PY{p}{(}\PY{n+nb}{sum}\PY{p}{(}\PY{n}{synch}    \PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{n}{Ntrials}\PY{p}{,}\PY{n}{Nms}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{\PYZgt{}}\PY{l+m+mi}{40}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
             \PY{p}{(}\PY{n+nb}{sum}\PY{p}{(}\PY{n}{radiating}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{n}{Ntrials}\PY{p}{,}\PY{n}{Nms}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{\PYZgt{}}\PY{l+m+mi}{40}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
             \PY{p}{(}\PY{n+nb}{sum}\PY{p}{(}\PY{n}{rotating} \PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{n}{Ntrials}\PY{p}{,}\PY{n}{Nms}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{\PYZgt{}}\PY{l+m+mi}{40}\PY{p}{)} \PY{o}{\PYZam{}}\PYZbs{}
             \PY{p}{(}\PY{n+nb}{sum}\PY{p}{(}\PY{n}{high}     \PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{n}{Ntrials}\PY{p}{,}\PY{n}{Nms}\PY{p}{)}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{\PYZgt{}}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{tr}    \PY{o}{=} \PY{n}{random}\PY{o}{.}\PY{n}{choice}\PY{p}{(}\PY{n}{find}\PY{p}{(}\PY{n}{diverse}\PY{p}{)}\PY{p}{)}
         \PY{n}{times} \PY{o}{=} \PY{n}{arange}\PY{p}{(}\PY{n}{Nms}\PY{p}{)}\PY{o}{/}\PY{l+m+mf}{1000.0}
         \PY{n}{a}     \PY{o}{=} \PY{n}{tr}\PY{o}{*}\PY{n}{Nms}
         \PY{n}{b}     \PY{o}{=} \PY{n}{a} \PY{o}{+} \PY{n}{Nms}
         \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{211}\PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{times}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{complexs}\PY{p}{[}\PY{n}{a}\PY{p}{:}\PY{n}{b}\PY{p}{]}  \PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{n}{WHITE}    \PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Complex}\PY{l+s+s2}{\PYZdq{}}    \PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{times}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{synch}\PY{p}{[}\PY{n}{a}\PY{p}{:}\PY{n}{b}\PY{p}{]}     \PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{n}{RUST}     \PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Synchronous}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{times}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{radiating}\PY{p}{[}\PY{n}{a}\PY{p}{:}\PY{n}{b}\PY{p}{]} \PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{n}{AZURE}    \PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Radiating}\PY{l+s+s2}{\PYZdq{}}  \PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{times}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{rotating}\PY{p}{[}\PY{n}{a}\PY{p}{:}\PY{n}{b}\PY{p}{]}  \PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{n}{TURQUOISE}\PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Rotating}\PY{l+s+s2}{\PYZdq{}}   \PY{p}{)}
         \PY{n}{fill\PYZus{}between}\PY{p}{(}\PY{n}{times}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{high}\PY{p}{[}\PY{n}{a}\PY{p}{:}\PY{n}{b}\PY{p}{]}\PY{o}{*}\PY{l+m+mf}{0.5}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{n}{BLACK}    \PY{p}{,}\PY{n}{linewidth}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{High\PYZhy{}beta}\PY{l+s+s2}{\PYZdq{}}  \PY{p}{)}
         \PY{n}{ylim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mf}{1.5}\PY{p}{)}\PY{p}{;} 
         \PY{n}{noy}\PY{p}{(}\PY{p}{)}
         \PY{n}{legend}\PY{p}{(}\PY{n}{bbox\PYZus{}to\PYZus{}anchor}\PY{o}{=}\PY{p}{(}\PY{l+m+mf}{1.04}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{n}{loc}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{upper left}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
         \PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Qualitative categorization trial }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{, pre\PYZhy{}object period}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{tr})
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{} Identify example events}
         \PY{c+c1}{\PYZsh{} There are no plane waves in PMv so skip those    }
         \PY{n}{tsynch} \PY{o}{=} \PY{n}{argmin}\PY{p}{(}\PY{n}{std}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{n}{Ndata}\PY{p}{,}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} In the paper, waves with many critical points \PYZdq{}complex\PYZdq{}}
         \PY{c+c1}{\PYZsh{} are lumped with ambiguous \PYZdq{}unclassified\PYZdq{} waves. For }
         \PY{c+c1}{\PYZsh{} illustration, locate a \PYZdq{}true\PYZdq{} complex wave by searching}
         \PY{c+c1}{\PYZsh{} times that are also asynchronous}
         \PY{n}{async}  \PY{o}{=} \PY{n}{std}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{n}{Ndata}\PY{p}{,}\PY{p}{)}\PY{p}{)}\PY{o}{\PYZgt{}}\PY{n}{pi}\PY{o}{/}\PY{l+m+mi}{2}
         \PY{n}{tcompl} \PY{o}{=} \PY{n}{argmax}\PY{p}{(}\PY{n}{ncrit} \PY{o}{*} \PY{n}{async} \PY{o}{*} \PY{n}{high}\PY{p}{)}
         \PY{n}{tcompl}   \PY{o}{=} \PY{p}{(}\PY{n}{random}\PY{o}{.}\PY{n}{choice}\PY{p}{(}\PY{n}{find}\PY{p}{(}\PY{p}{(}\PY{n}{ncrit}\PY{o}{\PYZgt{}}\PY{l+m+mi}{3}\PY{p}{)}\PY{o}{\PYZam{}}\PY{n}{async}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{trot}   \PY{o}{=} \PY{p}{(}\PY{n}{random}\PY{o}{.}\PY{n}{choice}\PY{p}{(}\PY{n}{find}\PY{p}{(}\PY{p}{(} \PY{n}{rotating}\PY{o}{==}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{\PYZam{}}\PY{p}{(}\PY{n}{radiating}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZam{}}\PY{p}{(}\PY{n}{ncrit}\PY{o}{==}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{\PYZam{}}\PY{n}{async}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{trad}   \PY{o}{=} \PY{p}{(}\PY{n}{random}\PY{o}{.}\PY{n}{choice}\PY{p}{(}\PY{n}{find}\PY{p}{(}\PY{p}{(}\PY{n}{radiating}\PY{o}{==}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{\PYZam{}}\PY{p}{(} \PY{n}{rotating}\PY{o}{==}\PY{l+m+mi}{0}\PY{p}{)}\PY{o}{\PYZam{}}\PY{p}{(}\PY{n}{ncrit}\PY{o}{==}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{\PYZam{}}\PY{n}{async}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Time (s)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{} Re\PYZhy{}order trial, time wave data into a single block}
         \PY{c+c1}{\PYZsh{} in order to retrieve wave data for each example.}
         \PY{n}{xcat} \PY{o}{=} \PY{n}{x}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
         \PY{n}{xcat} \PY{o}{=} \PY{n}{xcat}\PY{o}{.}\PY{n}{reshape}\PY{p}{(}\PY{p}{(}\PY{n}{Nrows}\PY{p}{,}\PY{n}{Ncols}\PY{p}{,}\PY{n}{Ntrials}\PY{o}{*}\PY{n}{Nms}\PY{p}{)}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{} Plot wave example from each category}
         \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{212}\PY{p}{)}
         \PY{n}{egt}  \PY{o}{=} \PY{n}{array}\PY{p}{(}\PY{p}{[}\PY{n}{tsynch}\PY{p}{,}\PY{n}{trot}\PY{p}{,}\PY{n}{trad}\PY{p}{,}\PY{n}{tcompl}\PY{p}{]}\PY{p}{)}
         \PY{n}{egs}  \PY{o}{=} \PY{n}{array}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sync Rotate Radiate Complex}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{p}{)}\PY{p}{)}
         \PY{k}{for} \PY{n}{i}\PY{p}{,}\PY{p}{(}\PY{n}{time}\PY{p}{,}\PY{n}{name}\PY{p}{)} \PY{o+ow}{in} \PY{n+nb}{enumerate}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n}{egt}\PY{p}{,}\PY{n}{egs}\PY{p}{)}\PY{p}{)}\PY{p}{:}
             \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{4}\PY{p}{,}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{5}\PY{p}{)}
             \PY{n}{w} \PY{o}{=} \PY{n}{dct\PYZus{}upsample}\PY{p}{(}\PY{n}{dct\PYZus{}cut\PYZus{}antialias}\PY{p}{(}\PY{n}{xcat}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n+nb}{int}\PY{p}{(}\PY{n}{time}\PY{p}{)}\PY{p}{]}\PY{p}{,}\PY{n}{smooth}\PY{p}{)}\PY{p}{,}\PY{n}{upsample}\PY{p}{)}
             \PY{n}{edgeavoid}\PY{o}{=}\PY{n+nb}{int}\PY{p}{(}\PY{n}{ceil}\PY{p}{(}\PY{n}{upsample}\PY{o}{*}\PY{l+m+mf}{1.5}\PY{p}{)}\PY{p}{)}
             \PY{n}{a} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{angle}\PY{p}{(}\PY{n}{w}\PY{p}{)}\PY{p}{[}\PY{n}{edgeavoid}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{n}{edgeavoid}\PY{p}{,}\PY{n}{edgeavoid}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{n}{edgeavoid}\PY{p}{]}
             \PY{n}{imshow}\PY{p}{(}\PY{n}{a}\PY{p}{,}\PY{n}{cmap} \PY{o}{=} \PY{n}{double\PYZus{}isolum}\PY{p}{,} \PY{n}{vmin}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{n}{pi}\PY{p}{,} \PY{n}{vmax}\PY{o}{=}\PY{n}{pi}\PY{p}{)}
             \PY{n}{noaxis}\PY{p}{(}\PY{p}{)}\PY{p}{;} \PY{n}{nox}\PY{p}{(}\PY{p}{)}\PY{p}{;} \PY{n}{noy}\PY{p}{(}\PY{p}{)}
             \PY{n}{t}  \PY{o}{=} \PY{n}{time}  \PY{o}{\PYZpc{}} \PY{l+m+mi}{1000}
             \PY{n}{tr} \PY{o}{=} \PY{n}{time} \PY{o}{/}\PY{o}{/} \PY{l+m+mi}{1000}
             \PY{n}{title}\PY{p}{(}\PY{n}{name}\PY{o}{+}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{trial }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{T=}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{ ms}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{tr}\PY{p}{,}\PY{n}{t}\PY{p}{)}\PY{p}{)}
             \PY{k}{if} \PY{n}{name} \PY{o+ow}{in} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Radiate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Rotate}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Complex}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
                 \PY{c+c1}{\PYZsh{} Ignore critical points during synchronous waves,}
                 \PY{c+c1}{\PYZsh{} which represent small fluctuations about the }
                 \PY{c+c1}{\PYZsh{} synchronous state.}
                 \PY{n}{clock}\PY{p}{,} \PY{n}{anticlock}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{\PYZus{}}\PY{p}{,} \PY{n}{maxima}\PY{p}{,} \PY{n}{minima} \PY{o}{=} \PY{n}{find\PYZus{}critical\PYZus{}points}\PY{p}{(}\PY{n}{w}\PY{p}{,}
                     \PY{n}{edgeavoid}\PY{o}{=}\PY{n}{edgeavoid}\PY{p}{)} \PY{c+c1}{\PYZsh{} Trim edges to remove boundary effects}
                 \PY{k}{for} \PY{n}{px}\PY{p}{,}\PY{n}{py} \PY{o+ow}{in} \PY{n+nb}{list}\PY{p}{(}\PY{n}{clock}\PY{p}{)} \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{anticlock}\PY{p}{)} \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{maxima}\PY{p}{)} \PY{o}{+} \PY{n+nb}{list}\PY{p}{(}\PY{n}{minima}\PY{p}{)}\PY{p}{:}
                     \PY{n}{scatter}\PY{p}{(}\PY{p}{[}\PY{n}{px}\PY{o}{\PYZhy{}}\PY{n}{edgeavoid}\PY{p}{]}\PY{p}{,}\PY{p}{[}\PY{n}{py}\PY{o}{\PYZhy{}}\PY{n}{edgeavoid}\PY{p}{]}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{n}{BLACK}\PY{p}{)}
             
         \PY{n}{subplots\PYZus{}adjust}\PY{p}{(}\PY{n}{hspace}\PY{o}{=}\PY{l+m+mf}{1.2}\PY{p}{,}\PY{n}{wspace}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_17_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{M1 wavelength calculation
demo}\label{m1-wavelength-calculation-demo}

Plane-wave events consistent with previously published observations were
seen in areas M1 and PMd in both subjects. To attenuate effects of noise
on wavelength estimates, we use a more stringent cutoff in the
phase-gradient directionality measure. In both subjects, area M1 showed
a sufficient number of plane waves that met this more stringent
criterion.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Load data
\item
  Plot data
\item
  Wavelength
\end{enumerate}

    \subsubsection{Load data from disk}\label{load-data-from-disk}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{session} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SPK120918}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{area}    \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{M1}\PY{l+s+s1}{\PYZsq{}}
         \PY{n}{name}    \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{\PYZus{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{\PYZus{}analytic\PYZus{}beta\PYZus{}LFP\PYZus{}select\PYZus{}trials}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{session}\PY{p}{,}\PY{n}{area}\PY{p}{)}
         \PY{n}{data}    \PY{o}{=} \PY{n}{loadmat}\PY{p}{(}\PY{n}{name}\PY{p}{,}\PY{n}{squeeze\PYZus{}me}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
         \PY{n}{x}       \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{betaAnalyticLFP1kHz}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{fa}      \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fa}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{fb}      \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{fb}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{fmid}    \PY{o}{=} \PY{n}{sqrt}\PY{p}{(}\PY{n}{fa}\PY{o}{*}\PY{n}{fb}\PY{p}{)}
         \PY{n}{Ntrials}\PY{p}{,} \PY{n}{Nrows}\PY{p}{,} \PY{n}{Ncols}\PY{p}{,} \PY{n}{Nms} \PY{o}{=} \PY{n}{x}\PY{o}{.}\PY{n}{shape}
         
         \PY{k}{print}\PY{p}{(}\PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{README}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
         \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{====Summary of }\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{====}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{name})
         \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Beta range }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{ \PYZhy{} }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{ Hz}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{fa}\PY{p}{,}\PY{n}{fb}\PY{p}{)}\PY{p}{)}
         \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{ trials}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{Ntrials})
         \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{ ms per trial}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{Nms})
         \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{ x }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{ spatial grid}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{Nrows}\PY{p}{,} \PY{n}{Ncols}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]

This archive contains selected spatiotemporal beta-LFP from the Cued Grasp 
with Instructed Delay (CGID) task for session SPK120918 area M1. These data are
provided for illustration purposes only, to demonstrate routines for 
calculating spatiotemporal phase statistics on multi-electrode arrays.
This archive includes data only from the one-second period before the 
object illumination in the CGID task.

The variables are as follows:

README:
    This message

betaAnalyticLFP1kHz:
    Ntrials x 8 x 6 x Ntimes complex-valued array of beta-LFP analytic signals
    For each trial, there is a 8 x 6 grid of beta-LFP analytic signals, 
    sampled at 1 kHz. LFP have been extracted using 4th order Butterworth 
    filtering applied forwards and backwards, with a low-frequency cutoff of 
    17.7 Hz and a high-frequency cutoff of 22.7 Hz. Analytic signals are 
    constructed using the Hilbert transform.

Ntrials : int
    Number of select trials provided for example

fa : float
    Beta-LFP band low-frequency cutoff

fb : float
    Beta-LFP band high-frequency cutoff


====Summary of SPK120918\_M1\_analytic\_beta\_LFP\_select\_trials====
Beta range 17 - 22 Hz
60 trials
1000 ms per trial
8 x 6 spatial grid

    \end{Verbatim}

    \subsubsection{Preview wave data}\label{preview-wave-data}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{} Plotting configuration}
         \PY{n}{tidx}     \PY{o}{=} \PY{l+m+mi}{0}   \PY{c+c1}{\PYZsh{} which trial to preview}
         \PY{n}{smooth}   \PY{o}{=} \PY{l+m+mf}{2.0} \PY{c+c1}{\PYZsh{} mm: smoothing radius for denoising}
         \PY{n}{upsample} \PY{o}{=} \PY{l+m+mi}{16}  \PY{c+c1}{\PYZsh{} Upsampling factor for plotting}
         \PY{n}{skip}     \PY{o}{=} \PY{l+m+mi}{7}   \PY{c+c1}{\PYZsh{} show every `skip` samples}
         \PY{n}{vrange}   \PY{o}{=} \PY{l+m+mi}{20}  \PY{c+c1}{\PYZsh{} millivolts; signal range}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{} Plot raw data}
         \PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
             \PY{n}{time} \PY{o}{=} \PY{n}{i}\PY{o}{*}\PY{n}{skip}
             \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{imshow}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{n}{tidx}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{time}\PY{p}{]}\PY{o}{.}\PY{n}{real}\PY{p}{,}\PY{n}{vmin}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{n}{vrange}\PY{p}{,}\PY{n}{vmax}\PY{o}{=}\PY{n}{vrange}\PY{p}{)}
             \PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{T=}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{time})
             \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}\PY{p}{;} \PY{n}{yticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
             \PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}0.1f}\PY{l+s+s1}{ mm}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{Ncols}\PY{o}{*}\PY{n}{Espacing}\PY{p}{)}\PY{p}{)}
         \PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Example trial }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{, wave preview — raw data}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{tidx}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}
         \PY{n}{show}\PY{p}{(}\PY{p}{)}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{} Plot denoised example}
         \PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
             \PY{n}{time} \PY{o}{=} \PY{n}{i}\PY{o}{*}\PY{n}{skip}
             \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{w} \PY{o}{=} \PY{n}{dct\PYZus{}upsample}\PY{p}{(}\PY{n}{dct\PYZus{}cut\PYZus{}antialias}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{n}{tidx}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{time}\PY{p}{]}\PY{p}{,}\PY{n}{smooth}\PY{p}{)}\PY{p}{,}\PY{n}{upsample}\PY{p}{)}
             \PY{n}{imshow}\PY{p}{(}\PY{n}{w}\PY{o}{.}\PY{n}{real}\PY{p}{,}\PY{n}{vmin}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{n}{vrange}\PY{p}{,}\PY{n}{vmax}\PY{o}{=}\PY{n}{vrange}\PY{p}{)}
             \PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{T=}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{time})
             \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}\PY{p}{;} \PY{n}{yticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
             \PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}0.1f}\PY{l+s+s1}{ mm}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{Espacing}\PY{o}{*}\PY{p}{(}\PY{n}{Ncols}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Example trial }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{, denoised}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{tidx}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{;}
         
         \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}\PYZsh{}}
         \PY{c+c1}{\PYZsh{} Plot phase maps}
         \PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         \PY{k}{for} \PY{n}{i} \PY{o+ow}{in} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{:}
             \PY{n}{time} \PY{o}{=} \PY{n}{i}\PY{o}{*}\PY{n}{skip}
             \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{,}\PY{n}{i}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}
             \PY{n}{w} \PY{o}{=} \PY{n}{dct\PYZus{}upsample}\PY{p}{(}\PY{n}{dct\PYZus{}cut\PYZus{}antialias}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{n}{tidx}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{p}{,}\PY{n}{time}\PY{p}{]}\PY{p}{,}\PY{n}{smooth}\PY{p}{)}\PY{p}{,}\PY{n}{upsample}\PY{p}{)}
             \PY{n}{imshow}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{angle}\PY{p}{(}\PY{n}{w}\PY{p}{)}\PY{p}{,}\PY{n}{cmap} \PY{o}{=} \PY{n}{double\PYZus{}isolum}\PY{p}{,} \PY{n}{vmin}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{n}{pi}\PY{p}{,} \PY{n}{vmax}\PY{o}{=}\PY{n}{pi}\PY{p}{)}
             \PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{T=}\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{k}{time})
             \PY{n}{xticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}\PY{p}{;} \PY{n}{yticks}\PY{p}{(}\PY{p}{[}\PY{p}{]}\PY{p}{)}
             \PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}0.1f}\PY{l+s+s1}{ mm}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{Espacing}\PY{o}{*}\PY{p}{(}\PY{n}{Ncols}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{)}
         \PY{n}{suptitle}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Example trial }\PY{l+s+si}{\PYZpc{}d}\PY{l+s+s1}{, phase map}\PY{l+s+s1}{\PYZsq{}}\PY{o}{\PYZpc{}}\PY{p}{(}\PY{n}{tidx}\PY{o}{+}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_22_2.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{Wavelength}\label{wavelength}

Focus only on planar wave events where the circular-standard deviation
of the phase gradient is less than π/4.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{th\PYZus{}sigma} \PY{o}{=} \PY{n}{pi}\PY{o}{/}\PY{l+m+mi}{4}
         \PY{n}{th}       \PY{o}{=} \PY{n}{exp}\PY{p}{(}\PY{n}{th\PYZus{}sigma}\PY{o}{*}\PY{o}{*}\PY{l+m+mi}{2}\PY{o}{*}\PY{o}{\PYZhy{}}\PY{l+m+mf}{0.5}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} reorder data to work with array routines}
         \PY{n}{x} \PY{o}{=} \PY{n}{data}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{betaAnalyticLFP1kHz}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{)}
         \PY{c+c1}{\PYZsh{} waves with PGD below threshold will get NaN assigned to their wavelength}
         \PY{n}{wavelength} \PY{o}{=} \PY{n}{array\PYZus{}wavelength\PYZus{}pgd\PYZus{}threshold}\PY{p}{(}\PY{n}{x}\PY{p}{,}\PY{n}{thresh}\PY{o}{=}\PY{n}{th}\PY{p}{)} \PY{c+c1}{\PYZsh{}mm/cycle}
         \PY{c+c1}{\PYZsh{} get instantaneous phase velocity}
         \PY{n}{radians\PYZus{}per\PYZus{}sample} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{median}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{diff}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{angle}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
         \PY{n}{speed\PYZus{}cm\PYZus{}s} \PY{o}{=} \PY{n}{radians\PYZus{}per\PYZus{}sample}\PY{o}{*}\PY{n}{Fs}\PY{o}{/}\PY{p}{(}\PY{l+m+mi}{2}\PY{o}{*}\PY{n}{pi}\PY{p}{)}\PY{o}{*}\PY{n}{wavelength}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{o}{/}\PY{l+m+mi}{10}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{8}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{)}
         
         \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{121}\PY{p}{)}
         \PY{n}{l} \PY{o}{=} \PY{n}{wavelength}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}
         \PY{n}{l} \PY{o}{=} \PY{n}{l}\PY{p}{[}\PY{n}{isfinite}\PY{p}{(}\PY{n}{l}\PY{p}{)}\PY{p}{]}
         \PY{n}{hist}\PY{p}{(}\PY{n}{l}\PY{p}{,}\PY{n}{bins}\PY{o}{=}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{,}\PY{l+m+mi}{101}\PY{p}{)}\PY{p}{,}\PY{n}{normed}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}\PY{p}{;}
         \PY{n}{xlim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{40}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Wavelength (mm)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Density}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{simpleaxis}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{subplot}\PY{p}{(}\PY{l+m+mi}{122}\PY{p}{)}
         \PY{n}{s} \PY{o}{=} \PY{n}{speed\PYZus{}cm\PYZus{}s}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}
         \PY{n}{s} \PY{o}{=} \PY{n}{s}\PY{p}{[}\PY{n}{isfinite}\PY{p}{(}\PY{n}{s}\PY{p}{)}\PY{p}{]}
         \PY{n}{hist}\PY{p}{(}\PY{n}{s}\PY{p}{,}\PY{n}{bins}\PY{o}{=}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{,}\PY{l+m+mi}{101}\PY{p}{)}\PY{p}{,}\PY{n}{normed}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}\PY{p}{;}
         \PY{n}{xlim}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{60}\PY{p}{)}
         \PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Phase speed (cm/s)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Density}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{simpleaxis}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_25_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
